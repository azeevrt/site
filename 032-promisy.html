<!DOCTYPE html>
<html lang="ru">
<head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
        <meta http-equiv="imagetoolbar" content="false">
        <link rel="preload" href="./theme/fonts/lato-v14-latin-300.woff2" as="font" type="font/woff2" /><!--  crossorigin  -->
        <link rel="preload" href="./theme/fonts/lato-v14-latin-700.woff2" as="font" type="font/woff2" /><!--  crossorigin  -->
        <link rel="preload" href="./theme/css/screen.css" as="style">
        <link rel="preload" href="./theme/css/user.css" as="style">

        <link rel="icon" type="image/x-icon" href="/favicon.ico">
        <title>032. Промисы</title>

        <link rel="stylesheet" href="./theme/css/screen.css" />
        <link rel="stylesheet" href="./theme/css/user.css" />
        <!--[if lt IE 9]>
  <script src="./theme/js/html5shiv.min.js"></script>
  <script src="./theme/js/respond.min.js"></script>
  <![endif]-->
</head>

<body class="wrap js" id="page-top">
  <header>
    <div class="flexbox">
      <div class="center-on-mobiles">
        <h1>
          <a href="./" class="logo">
            <span class="sr-only">Azeevrt</span>
            <img src="./theme/img/logo-2x.png" width="140" height="65" alt="Azeevrt Logo">
          </a>
        </h1>
      </div>
      <nav class="main-nav hide-on-mobiles">
        <ul>
          <li>
              <a href="./category/azeevrt.html">Azeevrt</a>
          </li>
          <li class="active">
              <a href="./category/nodejs.html">Node.js</a>
          </li>
        </ul>
      </nav>
      <div class="meta hide-on-mobiles">
        <ul>
              <li><a href="https://azeevrt.github.io/site">Azeevrt /site/</a></li>
        </ul>
      </div>
    </div>
    <nav class="mobile-nav show-on-mobiles">
      <ul>
          <li>
              <a href="./category/azeevrt.html">Azeevrt</a>
          </li>
          <li class="active">
              <a href="./category/nodejs.html">Node.js</a>
          </li>
    </ul>
    </nav>
  </header>
    <section class="standalone">
      <div class="grid">
        <div class="unit whole">
          <article>
            <h3>32. Промисы</h3>
<h5>Введение</h5>
<div class="highlight"><pre><span></span><span class="n">let</span> <span class="n">done</span> <span class="o">=</span> <span class="k">true</span>

<span class="n">const</span> <span class="n">isDoneYet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Promise</span><span class="p">((</span><span class="n">resolve</span><span class="p">,</span> <span class="n">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="err">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">done</span><span class="p">)</span> <span class="err">{</span>
        <span class="n">const</span> <span class="n">workDone</span> <span class="o">=</span> <span class="s1">&#39;Here is the thing I build&#39;</span>
        <span class="n">resolve</span><span class="p">(</span><span class="n">workDone</span><span class="p">)</span>
    <span class="err">}</span> <span class="k">else</span> <span class="err">{</span>
        <span class="n">const</span> <span class="n">why</span> <span class="o">=</span> <span class="s1">&#39;Still working on something else&#39;</span>
        <span class="n">reject</span><span class="p">(</span><span class="n">why</span><span class="p">)</span>
    <span class="err">}</span>
<span class="err">}</span><span class="p">)</span>

<span class="n">const</span> <span class="n">checkIfItsDone</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="err">{</span>
    <span class="n">isItDoneYet</span> 
        <span class="p">.</span><span class="k">then</span><span class="p">(</span><span class="n">ok</span> <span class="o">=&gt;</span> <span class="err">{</span>
            <span class="n">console</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>
        <span class="err">}</span><span class="p">)</span>
        <span class="p">.</span><span class="n">catch</span><span class="p">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="err">{</span>
            <span class="n">console</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="err">}</span><span class="p">)</span>
<span class="err">}</span>
</pre></div>


<p>Обычно, промис определяется как прокси для значения, которое будет доступно в будущем (promise - обещание). </p>
<p>Промисы являются средством для работы с асинхронным кодом без использования колбеков. </p>
<p>Промисы являются частью языка на протяжении многих лет (они были стандартизированы и представлены в ES2015 и оптимизированы в async/await в 2017 году). </p>
<p>В основе асинхронных функций лежат промисы, поэтому понимание того, как они работают является основой для понимания того, как работает async/await. </p>
<h5>Как работают промисы?</h5>
<p>Когда промис вызывается, начинается стадия ожидания. Это означает, что вызванная функция продолжает выполняться до разрешения промиса, возвращая запрошенные данные. </p>
<p>Созданный промис завершается стадией выполнения или отклонения, что влечет за собой вызов колбека (переданного в then или catch). </p>
<h5>Какие прикладные интерфейсы используют промисы?</h5>
<p>Промисы используются такими современными API, как:</p>
<ul>
<li>Battery</li>
<li>Fetch</li>
<li>Сервис-воркеры</li>
</ul>
<p>Едва ли в современном JavaScript вам удастся обойтись без промисов, так что давайте рассмотрим их подробнее. </p>
<h5>Создание промиса</h5>
<p>Promise API предоставляет конструктор промиса, который вызывается с помощью new Promise():</p>
<div class="highlight"><pre><span></span><span class="n">let</span> <span class="n">done</span> <span class="o">=</span> <span class="k">true</span>

<span class="n">const</span> <span class="n">isItDoneYet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Promise</span><span class="p">((</span><span class="n">resolve</span><span class="p">,</span> <span class="n">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="err">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">done</span><span class="p">)</span> <span class="err">{</span>
        <span class="n">const</span> <span class="n">workDone</span> <span class="o">=</span> <span class="s1">&#39;Here is the thing I built&#39;</span>
        <span class="n">resolve</span><span class="p">(</span><span class="n">workDone</span><span class="p">)</span>
    <span class="err">}</span> <span class="k">else</span> <span class="err">{</span>
        <span class="n">const</span> <span class="n">why</span> <span class="o">=</span> <span class="s1">&#39;Still working on something else&#39;</span>
        <span class="n">reject</span><span class="p">(</span><span class="n">why</span><span class="p">)</span>
    <span class="err">}</span>
<span class="err">}</span><span class="p">)</span>
</pre></div>


<p>Как видите, промис проверяет глобальную константу done, и, если ее значением является true, промис выполняется (вызывается колбек resolve); иначе, вызывается колбек reject, промис отклоняется (если ни один из названных колбеков не будет вызван, промис останется в стадии ожидания). </p>
<p>С помощью resolve и reject мы можем сообщать колбеку, каким было состояние промиса, и что с ним следует делать. В приведенном примере мы возвращали строку, но это может быть объект или null. В примере мы создаем промис таким способом, что он сразу начинает выполняться. Это важно для понимания раздела "Использование промиса" ниже. </p>
<p>Более распространенным случаем использования промисов является так называемая промисификация. Эта техника заключается в использовании обычной функции, принимающей колбек, являющийся промисом:</p>
<div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">)</span>

<span class="n">const</span> <span class="n">getFile</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">=&gt;</span> <span class="err">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Promise</span><span class="p">((</span><span class="n">resolve</span><span class="p">,</span> <span class="n">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="err">{</span>
        <span class="n">fs</span><span class="p">.</span><span class="n">readFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="k">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="err">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="err">{</span>
                <span class="n">reject</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;reject&#39;</span> <span class="err">вызывается</span> <span class="err">при</span> <span class="err">отклонении</span> <span class="err">промиса</span> <span class="err">с</span> <span class="err">или</span> <span class="err">без</span> <span class="err">ошибки</span><span class="p">,</span> <span class="err">переданной</span> <span class="err">в</span> <span class="err">качестве</span> <span class="err">аргумента</span><span class="p">,</span>
                            <span class="o">//</span> <span class="err">и</span> <span class="err">мы</span> <span class="err">не</span> <span class="err">хотим</span> <span class="err">двигаться</span> <span class="err">дальше</span>
                <span class="k">return</span> 
            <span class="err">}</span>
            <span class="n">resolve</span><span class="p">(</span><span class="k">data</span><span class="p">)</span> 
        <span class="err">}</span><span class="p">)</span>
    <span class="err">}</span><span class="p">)</span>
<span class="err">}</span>

<span class="n">getFile</span><span class="p">(</span><span class="s1">&#39;/etc/password&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="k">then</span><span class="p">(</span><span class="k">data</span> <span class="o">=&gt;</span> <span class="n">console</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="k">data</span><span class="p">))</span>
    <span class="p">.</span><span class="n">catch</span><span class="p">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="n">console</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
</pre></div>


<p>В последних версиях Node.js, вам не нужно делать промисификацию вручную для многих прикладных интерфейсов. Существует <a href="https://nodejs.org/docs/latest-v11.x/api/util.html#util_util_promisify_original">модуль util</a>, который делает это за вас, обеспечивая возврат правильного значения промисифицируемой функции. </p>
<h5>Использование промиса</h5>
<p>В предыдущем разделе мы рассмотрели, как создать промис. </p>
<p>Теперь давайте посмотрим, как можно его использовать. </p>
<div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">isItDoneYet</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Promise</span><span class="p">(...)</span>
<span class="o">//</span> <span class="p">...</span>

<span class="n">const</span> <span class="n">checkIfItsDone</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="err">{</span>
    <span class="n">isItDoneYet</span>
        <span class="p">.</span><span class="k">then</span><span class="p">(</span><span class="n">ok</span> <span class="o">=&gt;</span> <span class="err">{</span>
            <span class="n">console</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>
        <span class="err">}</span><span class="p">)</span>
        <span class="p">.</span><span class="n">catch</span><span class="p">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="err">{</span>
            <span class="n">console</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="err">}</span><span class="p">)</span>
<span class="err">}</span>
</pre></div>


<p>В функции checkIfItsDone() определяются функции, запускаемые при выполнении промиса isItDoneYet (в колбеке then) или при его отклонении (в колбеке catch). </p>
<h5>Цепочка из промисов</h5>
<p>Промисы могут возвращаться в качестве значений других промисов, формируя цепочки из промисов. </p>
<p>Отличным примером цепочки промисов является Fetch API, который может использоваться для получения ресурса и работы с ним посредством очереди - цепочки из промисов. </p>
<p>Fetch API - это механизм, основанный на промисах, и вызов fetch() эквивалентен созданию собственного промиса с помощью new Promise(): </p>
<h5>Пример цепочки промисов</h5>
<div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">status</span> <span class="o">=</span> <span class="n">response</span> <span class="o">=&gt;</span> <span class="err">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">status</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="n">response</span><span class="p">.</span><span class="n">status</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">)</span> <span class="err">{</span>
        <span class="k">return</span> <span class="n">Promise</span><span class="p">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="err">}</span>
    <span class="k">return</span> <span class="n">Promise</span><span class="p">.</span><span class="n">reject</span><span class="p">(</span><span class="k">new</span> <span class="n">Error</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">statusText</span><span class="p">))</span>
<span class="err">}</span>

<span class="n">const</span> <span class="n">json</span> <span class="o">=</span> <span class="n">response</span> <span class="o">=&gt;</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>

<span class="k">fetch</span><span class="p">(</span><span class="s1">&#39;/todos.json&#39;</span><span class="p">)</span>
    <span class="p">.</span><span class="k">then</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>   <span class="o">//</span> <span class="err">обратите</span> <span class="err">внимание</span><span class="p">,</span> <span class="err">что</span> <span class="err">функция</span> <span class="s1">&#39;status&#39;</span> <span class="err">вызывается</span> <span class="err">именно</span> <span class="err">здесь</span> <span class="err">и</span> <span class="err">возвращает</span> <span class="err">промис</span>
    <span class="p">.</span><span class="k">then</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>     <span class="o">//</span> <span class="err">единственным</span> <span class="err">отличием</span> <span class="err">является</span> <span class="err">то</span><span class="p">,</span> <span class="err">что</span> <span class="err">функция</span> <span class="s1">&#39;json&#39;</span> <span class="err">возвращает</span> <span class="err">промис</span><span class="p">,</span> <span class="err">который</span> <span class="err">разрешается</span> <span class="s1">&#39;data&#39;</span>
    <span class="p">.</span><span class="k">then</span><span class="p">(</span><span class="k">data</span> <span class="o">=&gt;</span> <span class="err">{</span> <span class="o">//</span> <span class="err">поэтому</span> <span class="s1">&#39;data&#39;</span> <span class="err">является</span> <span class="err">первым</span> <span class="err">параметром</span> <span class="err">анонимной</span> <span class="err">функции</span>
        <span class="n">console</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Request succeeded with JSON response &#39;</span><span class="p">,</span> <span class="k">data</span><span class="p">)</span>
    <span class="err">}</span><span class="p">)</span>
    <span class="p">.</span><span class="n">catch</span><span class="p">(</span><span class="n">error</span> <span class="o">=&gt;</span> <span class="err">{</span>
        <span class="n">console</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Request failed &#39;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
    <span class="err">}</span><span class="p">)</span>
</pre></div>


<p>В приведенном примере мы вызываем fetch() для получения списка задач из файла todos.json, находящегося в корневой директории, затем мы создаем цепочку промисов. </p>
<p>Запуск fetch() возвращает <a href="https://fetch.spec.whatwg.org/#concept-response">ответ</a>, имеющий много свойств, среди которых мы обращаемся к следующим: </p>
<ul>
<li>status - числовое значение кода статуса HTTP-ответа</li>
<li>statusText - статусное сообщение, например, OK в случае успешного запроса</li>
</ul>
<p>response также имеет метод json(), который возвращает промис, выполняющийся с разобранным (распарсенным) содержимым тела ответа. </p>
<p>С учетом изложенного, вот что происходит: первый промис в цепочке - это определенная нами функция status(), которая проверяет статус ответа, и, в случае, когда такой статус выходит за пределы диапазона 200-299, промис отклоняется. </p>
<p>При отклонении промиса операция сразу переходит к блоку catch(), в консоль выводится текст Request failed и сообщение об ошибке. </p>
<p>При успешном запросе вызывается функция json(). Поскольку предыдущий промис вернул объект response, мы получаем его в качестве параметра во втором промисе. </p>
<p>Далее мы разбираем (парсим) ответ, так что третий промис получает данные в нужном формате:</p>
<div class="highlight"><pre><span></span><span class="na">.then</span><span class="p">(</span><span class="no">data</span> <span class="err">=&gt;</span> <span class="no">console.log</span><span class="p">(</span><span class="err">&#39;</span><span class="no">Request</span> <span class="no">succeeded</span> <span class="no">with</span> <span class="no">JSON</span> <span class="no">response</span> <span class="err">&#39;</span><span class="p">,</span> <span class="no">data</span><span class="p">))</span>
</pre></div>


<p>И мы просто выводим эти данные в консоль. </p>
<h5>Обработка ошибок</h5>
<p>В примере у нас имелся блок catch в конце цепочки промисов. </p>
<p>Когда что-либо в цепочке завершается с ошибкой или когда промис отклоняется, управление переходит к блюжайшему блоку catch. </p>
<div class="highlight"><pre><span></span><span class="k">new</span> <span class="n">Promise</span><span class="p">((</span><span class="n">resolve</span><span class="p">,</span> <span class="n">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="err">{</span>
        <span class="n">throw</span> <span class="k">new</span> <span class="n">Error</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
    <span class="err">}</span><span class="p">).</span><span class="n">catch</span><span class="p">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="err">{</span>
        <span class="n">console</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="err">}</span><span class="p">)</span>

    <span class="o">//</span> <span class="err">или</span>

    <span class="k">new</span> <span class="n">Promise</span><span class="p">((</span><span class="n">resolve</span><span class="p">,</span> <span class="n">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="err">{</span>
        <span class="n">reject</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
    <span class="err">}</span><span class="p">).</span><span class="n">catch</span><span class="p">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="err">{</span>
        <span class="n">console</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="err">}</span><span class="p">)</span>
</pre></div>


<h5>Цепочка ошибок</h5>
<p>Если в catch() вы получили ошибку, вы можете добавить второй catch() для ее обработки и т.д. </p>
<div class="highlight"><pre><span></span><span class="err">new Promise((resolve, reject) =&gt; {</span>
<span class="err">        throw new Error(&#39;Error&#39;)</span>
<span class="err">    })</span>
<span class="err">    .catch(err =&gt; {</span>
<span class="err">        throw new Error(&#39;Error&#39;)</span>
<span class="err">    })</span>
<span class="err">    .catch(err =&gt; {</span>
<span class="err">        console.error(err)</span>
<span class="err">    })</span>
</pre></div>


<h5>Оркестровка промисов</h5>
<h6>Promise.all()</h6>
<p>Если вам необходимо синхронизировать разные промисы, Promise.all позволяет определить список промисов, и сделать что-либо после их выполнения.</p>
<p>Например:</p>
<div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">fecth</span><span class="p">(</span><span class="s1">&#39;/something.json&#39;</span><span class="p">)</span>
<span class="n">const</span> <span class="n">f2</span> <span class="o">=</span> <span class="k">fetch</span><span class="p">(</span><span class="s1">&#39;/something2.json&#39;</span><span class="p">)</span>

<span class="n">Promise</span><span class="p">.</span><span class="k">all</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">])</span>
    <span class="p">.</span><span class="k">then</span><span class="p">(</span><span class="n">res</span> <span class="o">=&gt;</span> <span class="err">{</span>
        <span class="n">console</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Array of results &#39;</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
    <span class="err">}</span><span class="p">)</span>
    <span class="p">.</span><span class="n">catch</span><span class="p">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="err">{</span>
        <span class="n">console</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="err">}</span><span class="p">)</span>
</pre></div>


<p>С помощью деструктурирующего присваивания это можно сделать так: </p>
<div class="highlight"><pre><span></span><span class="err">Promise.all([f1, f2]).then(([f1, f2]) =&gt; {</span>
<span class="err">    console.log(&#39;Results &#39;, res1, re2)</span>
<span class="err">})</span>
</pre></div>


<p>Разумеется, вы не ограничены fetch, в данном шаблоне проектирования могут использоваться любые промисы. </p>
<h6>Promise.race()</h6>
<p>Promice.race() запускается при выполнении первого промиса, т.е. колбек промиса выполняется один раз с результатом первого выполненного промиса. </p>
<p>Например: </p>
<div class="highlight"><pre><span></span><span class="n">const</span> <span class="k">first</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Promise</span><span class="p">((</span><span class="n">resolve</span><span class="p">,</span> <span class="n">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="err">{</span>
    <span class="n">setTimeout</span><span class="p">(</span><span class="n">resolve</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="err">}</span><span class="p">)</span>

<span class="n">const</span> <span class="k">second</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Promise</span><span class="p">((</span><span class="n">resolve</span><span class="p">,</span> <span class="n">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="err">{</span>
    <span class="n">setTimeout</span><span class="p">(</span><span class="n">resolve</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">)</span>
<span class="err">}</span><span class="p">)</span>

<span class="n">Promise</span><span class="p">.</span><span class="n">race</span><span class="p">([</span><span class="k">first</span><span class="p">,</span> <span class="k">second</span><span class="p">]).</span><span class="k">then</span><span class="p">(</span><span class="k">result</span> <span class="o">=&gt;</span> <span class="err">{</span>
    <span class="n">console</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="k">result</span><span class="p">)</span> <span class="o">//</span> <span class="k">second</span>
<span class="err">}</span><span class="p">)</span>
</pre></div>


<h5>Распространенные ошибки</h5>
<h6>Uncaught TypeError: undefined is not a promise</h6>
<p>Если в консоли вы получили ошибку Uncaught TypeError: undefined is not a promise, убедитесь в том, что используете new Promise(), а не просто Promise(). </p>
<h6>UnhandledPromiseRejectionWarning</h6>
<p>Это означает, что вызванный вами промис был отклонен, однако отсутствует блок catch для обработки возникшей ошибки. Добавьте catch в конец цепочки для решения этой проблемы.
`</p>

          </article><!-- /#posts-list -->
        </div>
        <div class="clear"></div>
      </div>
    </section>
<footer>
  <div class="grid">
    <div class="unit one-third center-on-mobiles">
  <h2>Р</h2>
    <ul class="inline-block text align-center list">
          <li><a href="https://github.com/azeevrt/site.git" target="_top">репозиторий</a></li>
    </ul><!-- /.blogroll -->
    </div>
    <div class="unit two-thirds align-right center-on-mobiles">
      <p>
        Гордо принимает 
        <a href="https://github.com">
          <img src="./theme/img/footer-logo.png" width="100" height="30" alt="GitHub • Социальное программирование">
        </a>
      </p>
    </div>
    <div class="unit two-thirds align-right center-on-mobiles">
      <h2>A</h2>
      <ul class="inline-block text align-center list">
              <li><a href="https://azeevrt.github.io/site">Azeevrt /site/</a></li>
      </ul><!-- /.social -->
    </div>
  </div>
</footer>
<a class="scroll-to-top rounded js-scroll-trigger button" href="#"><i class="fas fa-angle-up"></i></a>
<script src="./theme/js/jquery-2.2.4.min.js"></script>
<script type="text/javascript">
    // Smooth scrolling using jQuery easing
    $('a.js-scroll-trigger[href*="#"]:not([href="#"])').click(function() {
      if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
        if (target.length) {
          $('html, body').animate({
            scrollTop: target.offset().top
          }, 1000, "easeInOutExpo");
          return false;
        }
      }
    });


     $('.akkordeon').on('click', 'h2, h3, h4, strong', function () {
        var akk = $(this).parent().parent();
        var action;
        (!akk.attr('open')) ? action = 'expand': action = 'reduce';
        var section = 'page.module.part.' + action;

    });
</script>
</body>
</html>