### 14\. Пакетный менеджер

##### Введение

npm - это стандатный пакетный менеджер Node.js. 

В январе 2017 года в npm числилось свыше 350 000 пакетов, что сделало его самым большим репозиторием кода на одном языке программирования на Земле. Можете быть уверенными в том, что на сегодняшний день существуют пакеты для решения почти любых задач. 

Все начиналось с загрузки и управления зависимостями в Node.js, но вскоре данный инструмент стал активно использоваться при разработке клиентской части приложений. 

npm делает несколько вещей. 

Альтернативой npm является [yarn][anchor0].

##### Загрузка

npm управляет загрузкой зависимостей проекта.

Если в проекте существует файл package.json, с помощью запуска npm install будет установлено все, что требуется проекту, в каталог node\_modules, который создается при отсутствии. 

Определенный пакет можно установить с помощью `npm install <package-name\>`. 

Часто установка пакета сопровождается флагами:

* --save - установка пакета и добавление записи о нем в раздел "dependencies" файла package.json
* --save-dev - установка пакета и добавление записи о нем в раздел "devDependencies" файла package.json

Разница между этими файлами состоит в том, что devDependencies используется в целях разработки, например, для тестирования, а dependencies - в продакшне (при сборке готового проекта). 

##### Обновление пакетов

Обновление выполняется с помощью npm update. 

npm проверит пакеты на наличие новых версий, удовлетворяющих установленным ограничениям. 

Вы также можете обновить лишь определенный пакет: `npm update <package-name\>`. 

##### Версионирование

В дополнение к стандартной загрузке, npm поддерживает версионирование, поэтому вы можете определить конкретную версию пакета, или запросить более новую или старую версию. 

Вам часто придется сталкиваться с тем, что одна библиотека совместима только с определенной (мажорной) версией другой библиотеки. 

А также с багами последних релизов, которые не устраняются долгое время. 

Определение версий также способствует командной разработке, поскольку каждый член команды знает, какую версию использовать до обновления файла package.json. 

Во всех этих случаях помогает версионирование, в этом плане npm следует общепринятым стандартам. 

##### Выполнение задач

package.json поддерживает формат для определения команд, выполняемых в терминале, с помощью `npm run <task-name\>`. 

Например:
`
{
    "scripts": {
        "start-dev": "node lib/server-development",
        "start": "node lib/server-production"
    },
}
`

Распространенной практикой является использование этой возможности для запуска Webpack:
`
{
    "scripts": {
        "watch": "webpack --watch --progress --colors --config webpack.conf.js",
        "dev": "webpack --progress --colors --config webpack.conf.js",
        "prod": "NODE_ENV=production webpack -p --config webpack.conf.js"
    },
}
`

Это позволяет вместо набора длинных команд, которые легко забыть, или при наборе которых легко ошибиться, делать так:
`
npm run watch 
npm run dev 
npm run prod 
`

[anchor0]: https://classic.yarnpkg.com/en/

